[Как сделать так, чтобы документация не болела?](https://www.highload.ru/siberia/2019/meetups#2171805)

Конспект с митапа.

Ведущие: 

* Семён Факторович, documentat.io
* Николай Волынкин, Plesk, t.me/docops

# Intro

Техписатель документирует продукт, который уже сделан.
Есть документация «до»: требования, спецификации. Обычно пишет аналитик.
В архитектурной документации то же самое: есть доки «как мы хотим сделать» и доки «как мы сделали».

## Документация

* входные требования
* REST API
* Описание лучших практик
* Как решать типовую задачу Х: дописать модуль, тест...
* Sequence diagram
* User stories
* Шаблоны GUI, мокапы дизайна
* Дока для внешних разработчиков: tutorials, how to
* Релиз-план
* Installation guide, server deployment 
* «Паспорт» сервиса: от разработчиков к опсам
* README: что это такое, зачем, чьё
* Документация в коде
* Тесты на Gherkin?

Книжка: PMBOK, Project management body of knowledge.

В проекте есть стейкхолдеры и коммуникации между ними. Документация — способ реализовать канал коммуникации между двумя стейкхолдерами.

# Что бывает не так с документацией

## Документации нет
* нет подтверждения договореностей
* нужны ресурсы, чтобы сделать
* есть, но плохо доступна
* информация искажается

## Сложно структурировать
* как начать?

## Документация устарела или ошибочна

## Написана так, что извлекать информацию сложно
* перебор аббревиатур
* сложный стиль
* термины, непонятные читателю
* на языке, который неизвестен читателю
* нет примеров использования или иллюстраций

## Пользователь не хочет читать
* хочет решить проблему, а не изучать предметную область
* слишком много читать
* документация написана не для того, чтобы помочь пользователю
* есть конкурирующий канал коммуникации: спросить тимлида проще, чем читать доки

## Документация низкоприоритетна.

Обычно в команде разработки есть что ещё поделать. Свободное время идёт на техдолг.

# Что с этим делать

Process champion — человек, который начинает проповедовать и внедрять идею в команде, берёт на себя ответственность и доводит задачу до конца.

Документация хуже регламентирована, чем, например, разработка и тестирование.

Почитать про лучшие практики: [Tom Johnson, Documenting APIs](https://idratherbewriting.com/learnapidoc/)

## Инструментальный стек

Есть барьер на написание документации, во многом психологический. Неясно, как начать.

Решение:

* инструментальные сценарии и шаблоны документов. «Чтобы документировать микросервис, возьми инструкцию Х, заполни шаблон Y».

* критерии качества и проверки документов. Что должно быть в документе, когда мы считаем задачу выполненной.

## Роль документации в общем цикле разработки

Если строгого процесса нет, то его нет вообще. 

* В definition of done фичи входит документация на фичу
* Изменение кода и фичи => изменение документации

# Вопросы

Актуализация доки в Swagger:
* считать coverage с помощью Cucumber, проверять что не уменьшилось

Диаграмма с несколькими представлениями.
Человек выходит к чистой доске, рисует диаграмму с нуля и рассказывает. Всё это записываем на видео.

Есть опенсорсный продукт. Можно описать всё, но это слишком много. Можно описать часть.
Пользователи:
* которые онбордятся
* которые уже пользуются

Решение: посмотреть на практики больших опенсорсных продуктов, например [Google Protobuf
](https://developers.google.com/protocol-buffers/).
Для новых пользователей делать отдельную документацию. Необязательно текст, можно видео, доклады на конференциях, что угодно.
Строим «лесенки» для новых пользователей, по которым они могут зайти в продукт.

KnowledgeConf (апрель 2019), доклад Alexandre White про видеодокументацию.

Документация от программистов к программистам очень часто «прячет лес за деревьями»: детали заглушают общую картину. Как надо: «описываемая система — это..., она нужна, чтобы ... и позволит вам сделать...».

«Прочитав этот документ, вы сможете...», «по завершению этого документа у вас будет...», «этот документ расчитывает, что вы знаете...»



Книга «Пиши, сокращай».

Линтеры для документации: [testthedocs.org](https://testthedocs.org/index.html)

# Продукты с хорошей документацией

* Docker: полное описание команд
* Bitbucket REST API
* [Stripe](https://stripe.com/docs)
* [Square](https://squareup.com/us/en/developers)
* [Twilio](https://www.twilio.com/docs/)
* [Learn Git Branching](https://learngitbranching.js.org/)
* [Google Protobuf](https://developers.google.com/protocol-buffers/)
* [Gstreamer](https://gstreamer.freedesktop.org/documentation/)

# Ещё хорошие практики

* Postmortems
* Architecture Decision Record
* Глоссарий: описание концепта и обозначающих его терминов.
